HA$PBExportHeader$d_r_stat_vente_race.srd
release 10.5;
datawindow(units=0 timer_interval=0 color=16777215 processing=0 HTMLDW=no print.printername="" print.documentname="" print.orientation = 0 print.margin.left = 110 print.margin.right = 110 print.margin.top = 96 print.margin.bottom = 96 print.paper.source = 0 print.paper.size = 0 print.canusedefaultprinter=yes print.prompt=no print.buttons=no print.preview.buttons=no print.cliptext=no print.overrideprintjob=no print.collate=yes print.preview.outline=yes hidegrayline=no )
header(height=568 color="536870912" )
summary(height=160 color="536870912" height.autosize=yes )
footer(height=120 color="536870912" )
detail(height=100 color="536870912" height.autosize=yes )
table(column=(type=char(3) updatewhereclause=yes name=cie_no dbname="cie_no" )
 column=(type=number updatewhereclause=yes name=totqteexp dbname="totqteexp" )
 column=(type=number updatewhereclause=yes name=totprix dbname="totprix" )
 column=(type=number updatewhereclause=yes name=totqteexpan dbname="totqteexpan" )
 column=(type=number updatewhereclause=yes name=totprixan dbname="totprixan" )
 column=(type=char(100) updatewhereclause=yes name=descrace dbname="t_race.descrace" )
 column=(type=char(4) updatewhereclause=yes name=racecode dbname="t_race.racecode" )
 retrieve="SELECT 
#temp_sta_ven_rac_statfacture.CIE_NO, 
round(isnull(Sum(isnull(#temp_sta_ven_rac_statfactureDetail.QTE_EXP,0)),0),2) AS TotQteExp, 
round(isnull(Sum(isnull(#temp_sta_ven_rac_statfactureDetail.UPRIX,0) * isnull(#temp_sta_ven_rac_statfactureDetail.QTE_EXP,0)),0),2) AS TotPrix,

round(isnull((
SELECT Sum(isnull(g1.QTE_EXP,0)) 
FROM t_race a1
INNER JOIN ( t_classe b1 
INNER JOIN ( t_produit c1
INNER JOIN (#temp_sta_ven_rac_statfacture d1
INNER JOIN (t_Verrat e1
RIGHT JOIN (t_AssociationRaceProd f1
RIGHT JOIN #temp_sta_ven_rac_statfactureDetail g1 ON (f1.CodeProd) = (g1.PROD_NO)) 
ON e1.CodeVerrat = g1.VERRAT_NO) 
ON (d1.LIV_NO = g1.LIV_NO) 
AND (d1.CIE_NO = g1.CIE_NO))
ON (c1.NoProduit) = (g1.PROD_NO))
ON c1.NoClasse = b1.NoClasse)
ON a1.coderace = 
(If g1.VERRAT_NO is not null then e1.CodeRace else f1.CodeRace endif)
WHERE (g1.PROD_NO Like 'HEB%' OR b1.Semence = 1) AND d1.cie_no = #temp_sta_ven_rac_statfacture.cie_no
AND
(
(If g1.VERRAT_NO is not null then e1.CodeRace else f1.CodeRace endif) = (If #temp_sta_ven_rac_statfactureDetail.VERRAT_NO is not null then t_Verrat.CodeRace else 	t_AssociationRaceProd.CodeRace endif )
)
)
,0),2) AS TotQteExpAn,

round(isnull((SELECT Sum(g1.QTE_EXP * g1.UPRIX) 
FROM t_race a1
INNER JOIN ( t_classe b1 
INNER JOIN ( t_produit c1
INNER JOIN (#temp_sta_ven_rac_statfacture d1
INNER JOIN (t_Verrat e1
RIGHT JOIN (t_AssociationRaceProd f1
RIGHT JOIN #temp_sta_ven_rac_statfactureDetail g1 ON (f1.CodeProd) = (g1.PROD_NO)) 
ON e1.CodeVerrat = g1.VERRAT_NO) 
ON (d1.LIV_NO = g1.LIV_NO) 
AND (d1.CIE_NO = g1.CIE_NO))
ON (c1.NoProduit) = (g1.PROD_NO))
ON c1.NoClasse = b1.NoClasse)
ON a1.coderace = 
(If g1.VERRAT_NO is not null then e1.CodeRace else f1.CodeRace endif)

WHERE (g1.PROD_NO Like 'HEB%' OR b1.Semence = 1) AND d1.cie_no = #temp_sta_ven_rac_statfacture.cie_no 
AND
(
(If g1.VERRAT_NO is not null then e1.CodeRace else f1.CodeRace endif) = (If #temp_sta_ven_rac_statfactureDetail.VERRAT_NO is not null then t_Verrat.CodeRace else 	t_AssociationRaceProd.CodeRace endif )
)

),0),2) AS TotPrixAn,


t_Race.DescRace,  
If #temp_sta_ven_rac_statfactureDetail.VERRAT_NO is not null then 
	t_Verrat.CodeRace
else 
	t_AssociationRaceProd.CodeRace
endif AS RaceCode


FROM t_race 
INNER JOIN ( t_classe
INNER JOIN ( t_produit
INNER JOIN (#temp_sta_ven_rac_statfacture 
INNER JOIN (t_Verrat 
RIGHT JOIN (t_AssociationRaceProd 
RIGHT JOIN #temp_sta_ven_rac_statfactureDetail ON (t_AssociationRaceProd.CodeProd) = (#temp_sta_ven_rac_statfactureDetail.PROD_NO)) 
ON t_Verrat.CodeVerrat = #temp_sta_ven_rac_statfactureDetail.VERRAT_NO) 
ON (#temp_sta_ven_rac_statfacture.LIV_NO = #temp_sta_ven_rac_statfactureDetail.LIV_NO) 
AND (#temp_sta_ven_rac_statfacture.CIE_NO = #temp_sta_ven_rac_statfactureDetail.CIE_NO))
ON (t_Produit.NoProduit) = (#temp_sta_ven_rac_statfactureDetail.PROD_NO))
ON t_Produit.NoClasse = t_Classe.NoClasse)

ON t_Race.coderace = RaceCode


WHERE #temp_sta_ven_rac_statfacture.FACT_DATE >= :ad_debut And #temp_sta_ven_rac_statfacture.FACT_DATE <= :ad_fin
AND (#temp_sta_ven_rac_statfactureDetail.PROD_NO Like 'HEB%' OR t_Classe.Semence = 1)
GROUP BY 
#temp_sta_ven_rac_statfacture.CIE_NO, 
t_Race.DescRace,
RaceCode  
HAVING RaceCode Is NOT Null AND TotQteExp <> 0 " arguments=(("ad_debut", date),("ad_fin", date))  sort="cie_no A racecode A " )
group(level=1 header.height=304 trailer.height=136 by=("cie_no" ) newpage=yes header.color="536870912" trailer.color="536870912" )
compute(band=header alignment="0" expression="~"Imprim$$HEX2$$e9002000$$ENDHEX$$le: ~" + today()"border="0" color="33554432" x="2523" y="12" height="76" width="946" format="[GENERAL]" html.valueishtml="0"  name=compute_1  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="1073741824" )
compute(band=header alignment="2" expression="~"Pour la p$$HEX1$$e900$$ENDHEX$$riode du ~" +  string(ad_debut, 'yyyy-mm-dd') + ~" au ~" + string(ad_fin, 'yyyy-mm-dd')"border="0" color="33554432" x="480" y="344" height="168" width="2039" format="[GENERAL]" html.valueishtml="0"  name=compute_2  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="1073741824" )
bitmap(band=header filename="C:\ii4net\ii4sc\CIPQ\Copie de CIPQ.jpg" x="23" y="0" height="540" width="448" border="0"  name=p_1  tag="exclure_mr" visible="1" )
text(band=header alignment="2" text="Statistiques de ventes par race" border="0" color="33554432" x="507" y="8" height="320" width="1943" html.valueishtml="0"  name=t_1  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-24" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="1073741824" )
line(band=header x1="2519" y1="100" x2="3465" y2="100"  name=l_5 visible="1" pen.style="0" pen.width="9" pen.color="12639424"  background.mode="2" background.color="1073741824" )
text(band=header alignment="0" text="" border="0" color="33554432" x="2523" y="108" height="444" width="946" html.valueishtml="0"  name=filtre_t visible="1"  font.face="Tahoma" font.height="-8" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="1073741824" )
text(band=header.1 alignment="2" text="Cumulatif" border="2" color="33554432" x="2158" y="128" height="144" width="814" html.valueishtml="0"  name=t_4  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Mois courant" border="2" color="33554432" x="1463" y="128" height="144" width="681" html.valueishtml="0"  name=t_2  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="0" text="Description" border="0" color="33554432" x="311" y="200" height="64" width="357" html.valueishtml="0"  name=descrace_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
line(band=header.1 x1="18" y1="288" x2="3461" y2="288"  name=l_1  tag="exclure_mr" visible="1" pen.style="0" pen.width="5" pen.color="33554432"  background.mode="2" background.color="1073741824" )
text(band=header.1 alignment="2" text="Code race" border="0" color="33554432" x="27" y="140" height="136" width="265" html.valueishtml="0"  name=racecode_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Qt$$HEX1$$e900$$ENDHEX$$" border="0" color="33554432" x="1472" y="204" height="64" width="338" html.valueishtml="0"  name=totqteexp_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Dollars" border="0" color="33554432" x="1783" y="204" height="64" width="357" html.valueishtml="0"  name=totprix_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="0" text="Centre:" border="0" color="33554432" x="14" y="20" height="92" width="357" html.valueishtml="0"  name=cie_no_t  tag="" visible="1"  font.face="Tahoma" font.height="-14" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=header.1 id=1 alignment="0" tabsequence=32766 border="0" color="33554432" x="389" y="20" height="92" width="219" format="[general]" html.valueishtml="0"  name=cie_no  tag="" visible="1" edit.limit=3 edit.case=any edit.focusrectangle=no edit.autoselect=yes edit.autohscroll=yes  font.face="Tahoma" font.height="-14" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="%" border="2" color="33554432" x="2985" y="128" height="144" width="466" html.valueishtml="0"  name=t_5 visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Dollars" border="0" color="33554432" x="3223" y="204" height="64" width="224" html.valueishtml="0"  name=t_7 visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Dollars" border="0" color="33554432" x="2533" y="204" height="64" width="430" html.valueishtml="0"  name=totprixan_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Qt$$HEX1$$e900$$ENDHEX$$" border="0" color="33554432" x="2162" y="204" height="64" width="361" html.valueishtml="0"  name=totqteexpan_t  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
text(band=header.1 alignment="2" text="Qt$$HEX1$$e900$$ENDHEX$$" border="0" color="33554432" x="2990" y="204" height="64" width="224" html.valueishtml="0"  name=t_6 visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
line(band=header.1 x1="14" y1="296" x2="3456" y2="296"  name=l_2  tag="exclure_mr" visible="1" pen.style="0" pen.width="9" pen.color="12639424"  background.mode="2" background.color="1073741824" )
column(band=detail id=7 alignment="2" tabsequence=32766 border="0" color="33554432" x="27" y="8" height="76" width="265" format="[general]" html.valueishtml="0"  name=racecode  tag="exclure_mr" visible="1" edit.limit=4 edit.case=any edit.focusrectangle=no edit.autoselect=yes edit.autohscroll=yes  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=detail id=6 alignment="0" tabsequence=32766 border="0" color="33554432" x="302" y="8" height="76" width="1161" format="[general]" html.valueishtml="0"  name=descrace  tag="exclure_mr" visible="1" edit.limit=100 edit.case=any edit.focusrectangle=no edit.autoselect=yes edit.autohscroll=yes  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=detail id=2 alignment="2" tabsequence=32766 border="0" color="33554432" x="1472" y="8" height="76" width="338" format="[general]" html.valueishtml="0"  name=totqteexp  tag="exclure_mr" visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=yes edit.autohscroll=yes  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=detail id=4 alignment="2" tabsequence=32766 border="0" color="33554432" x="2162" y="8" height="76" width="361" format="[general]" html.valueishtml="0"  name=totqteexpan  tag="exclure_mr" visible="1" edit.limit=0 edit.case=any edit.focusrectangle=no edit.autoselect=yes edit.autohscroll=yes  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=detail id=3 alignment="1" tabsequence=32766 border="0" color="33554432" x="1783" y="8" height="76" width="366" format="[general]" html.valueishtml="0"  name=totprix  tag="exclure_mr" visible="1" editmask.mask="###,###.00" editmask.focusrectangle=no  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
column(band=detail id=5 alignment="1" tabsequence=32766 border="0" color="33554432" x="2533" y="8" height="76" width="430" format="[general]" html.valueishtml="0"  name=totprixan  tag="exclure_mr" visible="1" editmask.mask="###,###.00" editmask.focusrectangle=no  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=detail alignment="2" expression="string(round(if ( sum( totprix ) > 0  ,( totprix /  sum(totprix )) * 100 , 0),2),~"###,###.00~")"border="0" color="33554432" x="3227" y="8" height="76" width="224" format="[General]" html.valueishtml="0"  name=compute_4 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=detail alignment="2" expression="round(if ( sum(totqteexp) > 0  ,( totqteexp /  sum(totqteexp)) * 100 , 0),2)"border="0" color="33554432" x="2985" y="8" height="76" width="224" format="[GENERAL]" html.valueishtml="0"  name=compute_3 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="0" expression="~"Total centre ~" +  cie_no + ~":~""border="2" color="33554432" x="27" y="12" height="116" width="3429" format="[GENERAL]" html.valueishtml="0"  name=compute_5 visible="1"  font.face="Tahoma" font.height="-12" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="2" expression="sum( totqteexp for group 1)"border="0" color="33554432" x="1472" y="28" height="76" width="338" format="[GENERAL]" html.valueishtml="0"  name=compute_6 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="1" expression="string(round(sum(  totprix  for group 1),2),~"###,###.00~")"border="0" color="33554432" x="1783" y="28" height="76" width="366" format="[General]" html.valueishtml="0"  name=compute_7 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="2" expression="sum(  totqteexpan  for group 1)"border="0" color="33554432" x="2162" y="28" height="76" width="338" format="[GENERAL]" html.valueishtml="0"  name=compute_8 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="1" expression="string(round(sum(  totprixan  for group 1),2),~"###,###.00~")"border="0" color="33554432" x="2533" y="28" height="76" width="430" format="[General]" html.valueishtml="0"  name=compute_9 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="2" expression="string(round(if ( sum( totqteexp ) > 0  ,( sum(totqteexp for group 1)/  sum(totqteexp )) * 100 , 0),2),~"###,###.00~")"border="0" color="33554432" x="2985" y="28" height="64" width="224" format="[GENERAL]" html.valueishtml="0"  name=compute_11 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
compute(band=trailer.1 alignment="2" expression="string(round(if ( sum( totprix ) > 0  ,( sum(totprix for group 1)/  sum(totprix )) * 100 , 0),2),~"###,###.00~")"border="0" color="33554432" x="3227" y="28" height="64" width="224" format="[GENERAL]" html.valueishtml="0"  name=compute_10 visible="1"  font.face="Tahoma" font.height="-10" font.weight="400"  font.family="2" font.pitch="2" font.charset="0" background.mode="1" background.color="536870912" )
report(band=summary dataobject="d_r_stat_vente_race_sommaire" x="18" y="60" height="88" width="3451" border="0"  height.autosize=yes criteria="" nest_arguments=((" ad_debut "),(" ad_fin ")) trail_footer = yes  name=dw_1 visible="1"  slideup=directlyabove )
line(band=summary x1="14" y1="20" x2="3456" y2="20"  name=l_3 visible="1" pen.style="0" pen.width="5" pen.color="33554432"  background.mode="2" background.color="1073741824" )
line(band=summary x1="14" y1="28" x2="3456" y2="28"  name=l_4 visible="1" pen.style="0" pen.width="9" pen.color="12639424"  background.mode="2" background.color="1073741824" )
text(band=footer alignment="1" text="page~t~"Page ~" + Page() + ~" de ~" + pagecount()" border="2" color="0" x="5" y="12" height="64" width="3465" html.valueishtml="0"  name=t_3  tag="exclure_mr" visible="1"  font.face="Tahoma" font.height="-10" font.weight="700"  font.family="2" font.pitch="2" font.charset="0" background.mode="2" background.color="16777215" )
htmltable(border="1" )
htmlgen(clientevents="1" clientvalidation="1" clientcomputedfields="1" clientformatting="0" clientscriptable="0" generatejavascript="1" encodeselflinkargs="1" netscapelayers="0" pagingmethod=0 generatedddwframes="1" )
xhtmlgen() cssgen(sessionspecific="0" )
xmlgen(inline="0" )
xsltgen()
jsgen()
export.xml(headgroups="1" includewhitespace="0" metadatatype=0 savemetadata=0 )
import.xml()
export.pdf(method=0 distill.custompostscript="0" xslfop.print="0" )
export.xhtml()
